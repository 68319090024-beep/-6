<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earthquake Monitoring Dashboard</title>
    <style>
        :root {
            --primary: #2c3e50;
            --danger: #e74c3c;
            --success: #2ecc71;
            --warning: #f1c40f;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #ecf0f1; margin: 0; padding: 20px; color: var(--primary); }
        .container { max-width: 600px; margin: auto; }
        .header { text-align: center; padding: 20px; background: var(--primary); color: white; border-radius: 15px 15px 0 0; }
        
        .dashboard { background: white; padding: 20px; border-radius: 0 0 15px 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        
        .status-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .card { padding: 15px; border-radius: 10px; border: 1px solid #ddd; text-align: center; }
        .card h3 { margin: 0 0 10px 0; font-size: 14px; color: #7f8c8d; }
        .value { font-size: 24px; font-weight: bold; }
        
        .system-status { padding: 15px; border-radius: 10px; margin-bottom: 20px; font-weight: bold; text-align: center; }
        .status-ok { background: #d4edda; color: #155724; }
        .status-alert { background: #f8d7da; color: #721c24; animation: blink 1s infinite; }
        
        .controls { display: flex; gap: 10px; }
        button { flex: 1; padding: 15px; border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-stop { background: var(--warning); color: #000; }
        .btn-reset { background: var(--success); }
        button:hover { opacity: 0.8; transform: translateY(-2px); }

        @keyframes blink { 0% {opacity: 1;} 50% {opacity: 0.5;} 100% {opacity: 1;} }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>üì° ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß</h2>
    </div>
    
    <div class="dashboard">
        <div id="alarm-banner" class="system-status status-ok">
            ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ‡∏õ‡∏Å‡∏ï‡∏¥
        </div>

        <div class="status-grid">
            <div class="card">
                <h3>üå° ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</h3>
                <div class="value"><span id="temp">--</span> ¬∞C</div>
            </div>
            <div class="card">
                <h3>üì≥ ‡∏™‡∏±‡πà‡∏ô‡∏™‡∏∞‡πÄ‡∏ó‡∏∑‡∏≠‡∏ô</h3>
                <div id="vib-label" class="value">--</div>
            </div>
            <div class="card" style="grid-column: span 2;">
                <h3>üîä ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á</h3>
                <div id="sound-label" class="value">--</div>
            </div>
        </div>

        <div class="controls">
            <button class="btn-stop" onclick="control('stop')">üîá ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</button>
            <button class="btn-reset" onclick="control('reset')">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
    </div>
</div>

<script>
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å ESP8266
    function updateData() {
        fetch('/data')
            .then(response => response.json())
            .then(data => {
                document.getElementById('temp').innerText = data.temp;
                document.getElementById('vib-label').innerText = data.vib == 1 ? "‡∏õ‡∏Å‡∏ï‡∏¥" : "‚ö†Ô∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö";
                document.getElementById('sound-label').innerText = data.sound == 1 ? "‡∏õ‡∏Å‡∏ï‡∏¥" : "‚ö†Ô∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö";
                
                const banner = document.getElementById('alarm-banner');
                if(data.alert == true) {
                    banner.innerText = "üö® ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥!";
                    banner.className = "system-status status-alert";
                } else {
                    banner.innerText = "‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ‡∏õ‡∏Å‡∏ï‡∏¥";
                    banner.className = "system-status status-ok";
                }
            })
            .catch(err => console.log("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ..."));
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°
    function control(action) {
        fetch('/' + action)
            .then(() => alert("‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á " + action + " ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"));
    }

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡πÜ 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    setInterval(updateData, 2000);
</script>

</body>
</html>
